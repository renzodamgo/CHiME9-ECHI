Installing dependencies...
Requirement already satisfied: hydra-core in /users/acp24red/.conda/envs/echi_recipe/lib/python3.12/site-packages (1.3.2)
Requirement already satisfied: omegaconf<2.4,>=2.2 in /users/acp24red/.conda/envs/echi_recipe/lib/python3.12/site-packages (from hydra-core) (2.3.0)
Requirement already satisfied: antlr4-python3-runtime==4.9.* in /users/acp24red/.conda/envs/echi_recipe/lib/python3.12/site-packages (from hydra-core) (4.9.3)
Requirement already satisfied: packaging in /users/acp24red/.conda/envs/echi_recipe/lib/python3.12/site-packages (from hydra-core) (25.0)
Requirement already satisfied: PyYAML>=5.1.0 in /users/acp24red/.conda/envs/echi_recipe/lib/python3.12/site-packages (from omegaconf<2.4,>=2.2->hydra-core) (6.0.2)
Channels:
 - conda-forge
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done

# All requested packages already installed.

Collecting git+https://github.com/ftshijt/pysepm.git
  Cloning https://github.com/ftshijt/pysepm.git to /tmp/job.7583082/pip-req-build-bun628tn
  Resolved https://github.com/ftshijt/pysepm.git to commit e8336117d743adf59ba29ffb844297588e80831e
  Preparing metadata (pyproject.toml): started
  Preparing metadata (pyproject.toml): finished with status 'done'
Starting enhancement script...
[2025-08-13 23:35:35,208][root][INFO] - Hydra config:
paths:
  root_dir: data/working_dir
  echi_dir: data/chime9_echi
  exp_dir: data/working_dir/experiments/baseline
  evaluation_dir: data/working_dir/experiments/baseline/evaluation
  enhancement_dir: data/working_dir/experiments/baseline/enhancement
  train_ha_dir: data/working_dir/experiments/baseline/train_ha
  train_aria_dir: data/working_dir/experiments/baseline/train_aria
  enhancement_output_dir: data/working_dir/experiments/baseline/enhancement/{dataset}_submission
  signal_id: '{session}.{device}.{pid}'
  signal_dir: data/chime9_echi/{device}/{dataset}
  echi_signal: data/chime9_echi/{device}/{dataset}/{session}.{device}.wav
  ref_signal_dir: data/chime9_echi/ref/{dataset}
  ref_signal_file: data/chime9_echi/ref/{dataset}/{session}.{device}.{pid}.wav
  rainbow_signal_dir: data/chime9_echi/participant/{dataset}
  rainbow_signal_file: data/chime9_echi/participant/{dataset}/{pid}.wav
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  segment_info_dir: data/chime9_echi/metadata/ref/{dataset}
  segment_info_file: data/chime9_echi/metadata/ref/{dataset}/{session}.{device}.{pid}.csv
  ref_segment_dir: data/working_dir/ref_segments/{dataset}/{device}/{segment_type}
  train_input_dir: data/working_dir/train_segments/{dataset}/{device}
  train_input_file: data/working_dir/train_segments/{dataset}/{device}/{session}.{device}.{pid}.{segment}.wav
  train_rainbow_file: data/working_dir/participant/{dataset}/{pid}.wav
  train_target_dir: data/working_dir/train_segments/{dataset}/{device}_ref
  train_target_file: data/working_dir/train_segments/{dataset}/{device}_ref/{session}.{device}.{pid}.{segment}.wav
  enhancement_input_dir: data/working_dir/enhancement_inputs/{device}/{dataset}
  enhancement_input_file: data/working_dir/enhancement_inputs/{device}/{dataset}/{session}{device}.wav
  enhancement_raindow_dir: data/working_dir/enhancement_inputs/participant
  enhancement_rainbow_file: data/working_dir/enhancement_inputs/participant/{pid}.wav
  enhancement_output_file: data/working_dir/experiments/baseline/enhancement/{dataset}_submission/{session}.{device}.{pid}.wav
shared:
  exp_name: baseline
  model_sample_rate: 16000
  ref_sample_rate: 16000
  signal_bitdepth: PCM_16
  nchannels: 1
resample:
  device: ha
  dataset: dev
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  device_input_file: data/chime9_echi/{device}/{dataset}/{session}.{device}.wav
  device_output_file: data/working_dir/enhancement_inputs/{device}/{dataset}/{session}{device}.wav
  rainbow_input_file: data/chime9_echi/participant/{dataset}/{pid}.wav
  rainbow_output_file: data/working_dir/enhancement_inputs/participant/{pid}.wav
  output_sample_rate: 16000
  run: true
enhance:
  sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
  device: ha
  dataset: dev
  noisy_signal: data/working_dir/enhancement_inputs/{device}/{dataset}/{session}{device}.wav
  rainbow_signal: data/working_dir/enhancement_inputs/participant/{pid}.wav
  enhanced_signal: data/working_dir/experiments/baseline/enhancement/{dataset}_submission/{session}.{device}.{pid}.wav
  model_sample_rate: 16000
  ref_sample_rate: 16000
  bitdepth: PCM_16
  run: true
enhance_args:
  name: baseline
  args:
    inference_dir: data/working_dir/experiments/baseline/enhancement
    config_path: checkpoints/ha_config.yaml
    ckpt_path: checkpoints/ha_baseline.pt
    audio_device: ha
    window_size: 60
    stride: 56
exp_name: baseline
enhancement_name: baseline
device: ha
dataset: dev
model_sample_rate: 16000
ref_sample_rate: 16000
bitdepth: PCM_16
noisy_signal: data/working_dir/enhancement_inputs/{device}/{dataset}/{session}{device}.wav
rainbow_signal: data/working_dir/enhancement_inputs/participant/{pid}.wav
enhanced_signal: data/working_dir/experiments/baseline/enhancement/{dataset}_submission/{session}.{device}.{pid}.wav
sessions_file: data/chime9_echi/metadata/sessions.{dataset}.csv
enhancement_dir: data/working_dir/experiments/baseline/enhancement

[2025-08-13 23:35:35,339][root][INFO] - Preparing the ECHI dataset
